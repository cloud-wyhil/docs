---
title: 'SQL生成'
description: 'SQLクエリを生成する方法を学びます。'
icon: 'database'
---


## SQL生成の概要

バイブ・コーディングによる**SQL生成**は、複雑な結合（Join）文や集計関数を直接作成しなくても、自然語でデータ抽出要件を説明すれば、AIが即座に有効なクエリを作成してくれる機能です。特に掲示板の統計データや複雑な検索条件が必要な際に非常に有用です。

---

## ステップバイステップ・SQL生成と実行

### 1. データ抽出目的の説明
掲示板のDBに保存されたデータをもとに、どのような情報を得たいかをAIに説明します。

> **Prompt:** "掲示板のDBから『過去1ヶ月間で最もコメントが多かった記事TOP 5』を抽出する SQLクエリを書いて。記事のタイトルとコメント数も一緒に出力してほしい。"

### 2. スキーマの自動参照 (Context Aware)
AIはプロジェクト内のエンティティファイル（`Board.java`, `Comment.java`）や`schema.sql`を読み取り、テーブル名やカラム名を正確に把握した上でクエリを生成します。

### 3. DBツールの活用と検証
AIは生成されたクエリを単に提示するだけでなく、設定されたDB MCP Toolがあれば直接クエリを実行して結果を確認します。

* **Toolsの活用**: `run_terminal_command`を通じてローカルDBのCLIに接続したり、接続されたDB管理ツールを呼び出したりして、クエリ結果をユーザーに即座にレポートします。

---

## 実務での活用シナリオ

### 検索機能の強化
> **Prompt:** "タイトルと内容だけでなく、作成者のニックネームでも検索できるSQLクエリを作って。検索キーワードは部分一致（`LIKE %search%`）で設定して。"

### 統計データの抽出
> **Prompt:** "毎日作成される記事の数を日付別にグループ化して表示する統計用クエリを書いて。直近7日分のデータだけでいい。"

---

## 💡 SQL生成と管理のヒント

* **パフォーマンス最適化の依頼**: クエリ生成後、「このクエリがインデックスを適切に使用しているか確認し、データが増えても速度が低下しないようにチューニングして」と依頼してください。
* **Dialectの明示**: H2, MySQL, PostgreSQLなど、使用しているDBの種類を伝えると、そのDB専用の構文（関数、ページング処理など）で正確に生成されます。
* **セキュリティの検討**: AIが生成したクエリにSQLインジェクションのリスクがないか検討を依頼し、安全なパラメータバインド方式を適用してください。

---
